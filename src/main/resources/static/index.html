<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Cliente Quiosque</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #mensagens { border: 1px solid #ccc; height: 200px; overflow-y: scroll; padding: 10px; }
        input, button { margin-top: 10px; }
    </style>
</head>
<body>
    <h2>Quiosque</h2>
    <div id="mensagens"></div>
    <input type="text" id="mensagem" placeholder="Digite um pedido..." />
    <button onclick="enviar()">Enviar</button>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.5.1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <script>
        // Use caminho relativo sem hardcode de localhost
        const socket = new SockJS("/ws");
        const stompClient = Stomp.over(socket);

        stompClient.connect({}, () => {
            stompClient.subscribe('/topico/pedidos', (msg) => {
                const box = document.getElementById("mensagens");
                box.innerHTML += `<div><b>Pedido recebido:</b> ${msg.body}</div>`;
                box.scrollTop = box.scrollHeight;
            });
        });

        function enviar() {
            const msg = document.getElementById("mensagem").value;
            if(msg.trim() === "") return;
            stompClient.send("/app/pedido", {}, msg);
            document.getElementById("mensagem").value = "";
        }
    </script>
</body>
</html>
